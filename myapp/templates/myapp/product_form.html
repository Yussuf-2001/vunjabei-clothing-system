{% extends 'myapp/base.html' %}

{% block title %}{% if product %}Edit Product{% else %}Add Product{% endif %}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0 text-gray-800">{% if product %}Edit Product{% else %}Add New Product{% endif %}</h1>
    <a href="{% url 'product_list' %}" class="btn btn-secondary">
        <i class="fas fa-arrow-left me-2"></i>Back to Products
    </a>
</div>

<div class="card shadow">
    <div class="card-body">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="name" class="form-label">Product Name</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ product.name|default:'' }}" required>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="category" class="form-label">Category</label>
                    <select class="form-select" id="category" name="category">
                        <option value="">Select a category</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}" {% if product.category.id == category.id %}selected{% endif %}>
                                {{ category.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="price" class="form-label">Price (TSh)</label>
                    <input type="number" step="0.01" class="form-control" id="price" name="price" value="{{ product.price|default:'' }}" required>
                </div>
            </div>

            <div class="mb-3">
                <label for="quantity" class="form-label">Quantity in Stock</label>
                <input type="number" class="form-control" id="quantity" name="quantity" value="{{ product.quantity|default:'' }}" required>
            </div>

            <div class="mb-3">
                <label for="image" class="form-label">Product Image</label>
                <input type="file" class="form-control" id="image" name="image" accept="image/*">
                {% if product.image %}
                    <small class="form-text text-muted">Current image: <a href="{{ product.image.url }}" target="_blank">{{ product.image.name }}</a></small>
                {% endif %}
            </div>

            <button type="submit" class="btn btn-primary">{% if product %}Update Product{% else %}Save Product{% endif %}</button>
        </form>
    </div>
</div>
{% endblock %}